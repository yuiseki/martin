<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Development - Martin Tile Server Documentation</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="introduction.html">Introduction</a></li><li class="chapter-item expanded "><a href="quick-start.html"><strong aria-hidden="true">1.</strong> Quick Start</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="quick-start-linux.html"><strong aria-hidden="true">1.1.</strong> On Linux</a></li><li class="chapter-item expanded "><a href="quick-start-macos.html"><strong aria-hidden="true">1.2.</strong> On macOS</a></li><li class="chapter-item expanded "><a href="quick-start-windows.html"><strong aria-hidden="true">1.3.</strong> On Windows</a></li><li class="chapter-item expanded "><a href="quick-start-qgis.html"><strong aria-hidden="true">1.4.</strong> View with QGIS</a></li></ol></li><li class="chapter-item expanded "><a href="installation.html"><strong aria-hidden="true">2.</strong> Installation</a></li><li class="chapter-item expanded "><a href="run.html"><strong aria-hidden="true">3.</strong> Running</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="run-with-cli.html"><strong aria-hidden="true">3.1.</strong> Command Line Interface</a></li><li class="chapter-item expanded "><a href="env-vars.html"><strong aria-hidden="true">3.2.</strong> Environment Variables</a></li><li class="chapter-item expanded "><a href="run-hosting-environment.html"><strong aria-hidden="true">3.3.</strong> Hosting Environment–specific Guides</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="run-with-docker.html"><strong aria-hidden="true">3.3.1.</strong> Docker</a></li><li class="chapter-item expanded "><a href="run-with-docker-compose.html"><strong aria-hidden="true">3.3.2.</strong> Docker Compose</a></li><li class="chapter-item expanded "><a href="run-with-lambda.html"><strong aria-hidden="true">3.3.3.</strong> AWS Lambda</a></li></ol></li><li class="chapter-item expanded "><a href="run-with-reverse-proxy.html"><strong aria-hidden="true">3.4.</strong> Reverse Proxies</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="run-with-nginx.html"><strong aria-hidden="true">3.4.1.</strong> NGINX</a></li><li class="chapter-item expanded "><a href="run-with-apache.html"><strong aria-hidden="true">3.4.2.</strong> Apache</a></li></ol></li><li class="chapter-item expanded "><a href="troubleshooting.html"><strong aria-hidden="true">3.5.</strong> Troubleshooting</a></li></ol></li><li class="chapter-item expanded "><a href="config-file.html"><strong aria-hidden="true">4.</strong> Configuration File</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="sources-tiles.html"><strong aria-hidden="true">4.1.</strong> Tile sources</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="sources-files.html"><strong aria-hidden="true">4.1.1.</strong> MBTiles and PMTiles File Sources</a></li><li class="chapter-item expanded "><a href="pg-connections.html"><strong aria-hidden="true">4.1.2.</strong> PostgreSQL Connections</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="sources-pg-tables.html"><strong aria-hidden="true">4.1.2.1.</strong> PostgreSQL Table Sources</a></li><li class="chapter-item expanded "><a href="sources-pg-functions.html"><strong aria-hidden="true">4.1.2.2.</strong> PostgreSQL Function Sources</a></li></ol></li><li class="chapter-item expanded "><a href="sources-composite.html"><strong aria-hidden="true">4.1.3.</strong> Composite Sources</a></li></ol></li><li class="chapter-item expanded "><a href="sources-resources.html"><strong aria-hidden="true">4.2.</strong> Supporting Resources</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="sources-sprites.html"><strong aria-hidden="true">4.2.1.</strong> Sprites</a></li><li class="chapter-item expanded "><a href="sources-styles.html"><strong aria-hidden="true">4.2.2.</strong> Styles</a></li><li class="chapter-item expanded "><a href="sources-fonts.html"><strong aria-hidden="true">4.2.3.</strong> Fonts</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="using.html"><strong aria-hidden="true">5.</strong> Available API Endpoints</a></li><li class="chapter-item expanded "><a href="using-guides.html"><strong aria-hidden="true">6.</strong> Guides</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="using-with-renderer.html"><strong aria-hidden="true">6.1.</strong> Map renderer specific</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="using-with-maplibre.html"><strong aria-hidden="true">6.1.1.</strong> MapLibre</a></li><li class="chapter-item expanded "><a href="using-with-leaflet.html"><strong aria-hidden="true">6.1.2.</strong> Leaflet</a></li><li class="chapter-item expanded "><a href="using-with-deck-gl.html"><strong aria-hidden="true">6.1.3.</strong> deck.gl</a></li><li class="chapter-item expanded "><a href="using-with-mapbox.html"><strong aria-hidden="true">6.1.4.</strong> Mapbox</a></li><li class="chapter-item expanded "><a href="using-with-openlayers.html"><strong aria-hidden="true">6.1.5.</strong> OpenLayers</a></li></ol></li><li class="chapter-item expanded "><a href="using-with-data.html"><strong aria-hidden="true">6.2.</strong> Tile source specific</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="recipes.html"><strong aria-hidden="true">6.2.1.</strong> Using Hosted PostgreSQL</a></li><li class="chapter-item expanded "><a href="recipe-basemap-postgis.html"><strong aria-hidden="true">6.2.2.</strong> Setting up a basemap and overlaying data</a></li></ol></li><li class="chapter-item expanded "><a href="martin-cp.html"><strong aria-hidden="true">6.3.</strong> Bulk Tile Generation</a></li><li class="chapter-item expanded "><a href="mbtiles.html"><strong aria-hidden="true">6.4.</strong> Working with MBTiles archives</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="mbtiles-schema.html"><strong aria-hidden="true">6.4.1.</strong> MBTiles Schemas</a></li><li class="chapter-item expanded "><a href="mbtiles-meta.html"><strong aria-hidden="true">6.4.2.</strong> Accessing Metadata</a></li><li class="chapter-item expanded "><a href="mbtiles-copy.html"><strong aria-hidden="true">6.4.3.</strong> Copying MBTiles</a></li><li class="chapter-item expanded "><a href="mbtiles-diff.html"><strong aria-hidden="true">6.4.4.</strong> Diffing/Patching MBTiles</a></li><li class="chapter-item expanded "><a href="mbtiles-validation.html"><strong aria-hidden="true">6.4.5.</strong> Validating MBTiles</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="development.html" class="active"><strong aria-hidden="true">7.</strong> Development</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="getting-involved.html"><strong aria-hidden="true">7.1.</strong> Getting involved</a></li><li class="chapter-item expanded "><a href="tools.html"><strong aria-hidden="true">7.2.</strong> Provided Tools</a></li><li class="chapter-item expanded "><a href="martin-as-a-library.html"><strong aria-hidden="true">7.3.</strong> Martin as a library</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Martin Tile Server Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/maplibre/martin" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/maplibre/martin/edit/main/docs/src/development.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="development"><a class="header" href="#development">Development</a></h1>
<h2 id="git-setup"><a class="header" href="#git-setup">Git setup</a></h2>
<p>The recommended setup for both core and casual contributors is to <strong>always</strong> create a fork
of the primary repo under their own account. The local repo should have two remotes: <code>upstream</code> pointing to the primary <code>maplibre/martin</code> repo, and <code>origin</code> pointing to the user’s own fork. The <code>main</code> branch should track <code>upstream/main</code>, but all new work will be pushed to <code>origin</code> and PRs will be created from there.</p>
<details><summary>Rationale for this setup (click to expand)</summary>
<p><small>This rationale was copied from <a href="https://gist.github.com/nyurik/4e299ad832fd2dd43d2b27191ed3ec30">a post</a> by Yuri</small></p>
<p>Open source contribution is both a technical and a social phenomenon.
Any FOSS project naturally has a “caste system” - a group
of contributors with extensive rights vs everyone else. Some of this separation
is necessary - core contributors have deeper knowledge of the code, share vision,
and trust each other.</p>
<p>Core contributors have one more right that others do not – they can create repository branches.
Thus, they can contribute “locally” - by pushing proposed changes to the primary repository’s work branches,
and create “local” pull requests inside the same repo.  This is different from others,
who can contribute only from their own forks.</p>
<p>There is little difference between creating pull requests from one’s own fork and from the primary repo,
and there are a few reasons why core contributors should <strong>never</strong> do it from the primary repo:</p>
<ul>
<li>it ensures that casual contributors always run the same CI as core contributors. If contribution process breaks, it will affect everyone, and will get fixed faster.</li>
<li>it puts everyone on the same leveled playing field, reducing the “caste system” effect, making the project feel more welcoming to new contributors</li>
<li>it ensures that the primary repo only has maintained branches (e.g. <code>main</code> and <code>v1.x</code>),
not a bunch of PR branches whose ownership and work status is unclear to everyone</li>
</ul>
<p>In the martin repository, we follow this and have a branch protection rule that prevents core contributors from creating pull requests from the primary repo.</p>
</details>
<pre><code class="language-bash"># clone the primary fork to your local machine, naming the remote "upstream"
# make sure to replace the URL with the correct one
git clone -o upstream https://github.com/maplibre/martin.git
cd martin

# add your own fork as a remote, naming it "origin"
git remote add origin https://github.com/nyurik/martin.git
</code></pre>
<p>For further setup instructions for IDEs, please see the <a href="getting-involved.html">Getting Involved</a> step after you have installed the necessary tools below.</p>
<details><summary>If you have already cloned the repo locally, use this guide to update your setup (click to expand)</summary>
<p>If you already cloned the repo locally, you can update it to use the new setup. This assumes you have a local clone of the repo, the remote name is <code>origin</code>, and you have already forked the repo on GitHub.</p>
<pre><code class="language-bash"># Getting a quick glance about your remotes: git remote -v
git remote -v
# Rename the existing remote to "upstream". Your "main" branch will now track "upstream/main"
git remote rename origin upstream

# Add your own fork as a remote, naming it "origin" (adjust the URL)
git remote add origin https://github.com/nyurik/martin.git
</code></pre>
</details>
<h3 id="contributing-new-code"><a class="header" href="#contributing-new-code">Contributing New Code</a></h3>
<pre><code class="language-bash"># switch to main branch (tracking upstream/main), and pull the latest changes
git switch main
git fetch upstream

# create a new branch for your work
git switch -c my-new-feature

# edit files, and commit changes
# '-a' will add all modified files
# `-m` allows you to add a short commit message
git commit -a -m "My new feature"

# push the changes to your own fork
# '-u' will track your local branch with the remote
git push -u origin my-new-feature

# Click the link shown by `git push` in the terminal to create a pull request
# from your fork using the GitHub web interface
</code></pre>
<h2 id="installed-tools-and-libraries"><a class="header" href="#installed-tools-and-libraries">Installed tools and libraries</a></h2>
<p>Install a few required libs and tools:</p>
<pre><code class="language-bash  ignore"># For Ubuntu-based distros
sudo apt update
sudo apt install -y build-essential pkg-config jq file gdal-bin
</code></pre>
<h3 id="docker"><a class="header" href="#docker">docker</a></h3>
<p>Install <a href="https://docs.docker.com/get-docker/">docker</a> and <a href="https://docs.docker.com/compose/">docker-compose</a></p>
<pre><code class="language-bash  ignore"># Ubuntu-based distros have an older version that might also work:
sudo apt install -y  docker.io docker-compose
</code></pre>
<h3 id="just"><a class="header" href="#just">just</a></h3>
<p>Install <a href="https://github.com/casey/just#readme">Just</a> (improved makefile processor). Note that some Linux and Homebrew
distros have outdated versions of Just, so you should install it from source:</p>
<pre><code class="language-bash  ignore">cargo install just --locked
</code></pre>
<p>When developing MBTiles SQL code, you may need to use <code>just prepare-sqlite</code> whenever SQL queries are modified.
Run <code>just</code> to see all available commands.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="mbtiles-validation.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="getting-involved.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="mbtiles-validation.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="getting-involved.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
